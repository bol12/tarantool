test_run = require('test_run').new()
---
...
test_run:cmd("push filter '127.0.0.1:.*' to '127.0.0.1:<port>'")
---
- true
...
--
-- gh-3234: SWIM gossip protocol.
--
s = swim.new()
---
...
s:delete()
---
...
s = nil
---
...
-- Check that SWIM gc can cope with manually deleted instance.
_ = collectgarbage()
---
...
s = swim.new()
---
...
s = nil
---
...
-- Check auto gc of active instances.
_ = collectgarbage()
---
...
uri = '127.0.0.1:<port>
---
...
s1, err = swim.new({server = uri, uuid = uuids[1], heartbeat = 0.01})
---
...
err
---
- null
...
s2, err = swim.new({server = uri, uuid = uuids[2], heartbeat = 0.01})
---
...
err
---
- null
...
s1:info()
---
- 127.0.0.1:<port>
    status: alive
    uuid: 00000000-0000-0000-0000-000000000001
...
s2:info()
---
- 127.0.0.1:<port>
    status: alive
    uuid: 00000000-0000-0000-0000-000000000002
...
s1:delete()
---
...
s2:delete()
---
...
test_run:cmd("clear filter")
---
- true
...
